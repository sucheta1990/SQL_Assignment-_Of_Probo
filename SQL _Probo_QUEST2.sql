create database Probo_Sales;
USE PROBO_SALES;
DROP TABLE SALES_TABLE;
CREATE TABLE SALES_TABLE(
CITY VARCHAR(20),
YEAR INT unsigned,
MONTH INT,
SALES DECIMAL(8,2));

INSERT INTO SALES_TABLE VALUES
('Delhi',2020,5,4300),
('Delhi',2020,6,2000),
('Delhi',2020,7,2100),
('Delhi',2020,8,2200),
('Delhi',2020,9,1900),
('Delhi',2020,10,200),
('Mumbai',2020,5,4400),
('Mumbai',2020,6,2800),
('Mumbai',2020,7,6000),
('Mumbai',2020,8,9300),
('Mumbai',2020,9,4200),
('Mumbai',2020,10,9700),
('Bangalore',2020,5,1000),
('Bangalore',2020,7,6800),
('Bangalore',2020,8,7000),
('Bangalore',2020,9,2300),
('Bangalore',2020,10,8400);
 
 SELECT * FROM SALES_TABLE;
SELECT A.*, B.SALES AS 'PREVOIUS MONTH SALES',C.SALES AS 'NEXT_MONTH_SALES',
SUM(A.SALES) OVER (PARTITION BY A.CITY ORDER BY A.MONTH ) AS 'YTD SALES'
FROM SALES_TABLE A
 LEFT JOIN SALES_TABLE B ON A.CITY=B.CITY AND B.MONTH= A.MONTH-1
 LEFT JOIN SALES_TABLE C ON A.CITY=C.CITY AND C.MONTH=A.MONTH +1
 
